# API Gateway Upstream Configuration
upstream apigateway {
    least_conn;
    server apigateway:8080 max_fails=3 fail_timeout=30s;    
    keepalive 32;
    keepalive_requests 100;
    keepalive_timeout 60s;
}

# API Gateway health check
upstream apigateway_health {
    server apigateway:8080;
    keepalive 1;
}